import static java.lang.System.*

group 'selenide_kotlin_practice'
version '0.0.1'

apply plugin: 'java'
apply plugin: 'kotlin'
apply plugin: 'io.qameta.allure'


sourceCompatibility = 1.8

buildscript {

    ext.allureVersion = '2.12.1'
    ext.allureGradleVersion = '2.8.1'
    ext.kotlinReflectVersion = '1.3.41'
    ext.kotlinVersion = '1.3.41'
    ext.junitJupiterVersion = '5.5.0'
    ext.selenideVersion = '5.2.3'
    ext.kluentVersion = '1.49'
    ext.webdriverManagerVersion = '2.2.1'

    repositories {
        jcenter()
        maven {
            url "https://plugins.gradle.org/m2/"
        }
    }
    dependencies {
        classpath "org.jetbrains.kotlin:kotlin-gradle-plugin:${kotlinVersion}"
        classpath "io.qameta.allure:allure-gradle:${allureGradleVersion}"
    }
}

repositories {
    jcenter()
    mavenCentral()
}

dependencies {
    compile("org.jetbrains.kotlin:kotlin-reflect:${kotlinReflectVersion}")
    compile("org.jetbrains.kotlin:kotlin-stdlib-jdk8:${kotlinVersion}")
    compile("io.github.bonigarcia:webdrivermanager:${webdriverManagerVersion}")
    compile("org.jetbrains.kotlin:kotlin-stdlib:${kotlinVersion}")
    compile("com.codeborne:selenide:${selenideVersion}")
    compile("io.qameta.allure:allure-selenide:${allureVersion}")
    compile("org.amshove.kluent:kluent:${kluentVersion}")
    compile("org.junit.jupiter:junit-jupiter:${junitJupiterVersion}")
}

compileKotlin {
    kotlinOptions.jvmTarget = "1.8"
}
compileTestKotlin {
    kotlinOptions.jvmTarget = "1.8"
}

test {
    useJUnitPlatform()

    testLogging {
        showStandardStreams = true
        events "passed", "skipped", "failed"
        exceptionFormat = "full"
    }

    reports {
        html.enabled = true
    }

    systemProperties = [
            'browser': getProperty("browser"),
            'junit.jupiter.execution.parallel.enabled': true,
            'junit.jupiter.execution.parallel.config.strategy': 'fixed',
            'junit.jupiter.execution.parallel.config.fixed.parallelism': 2
    ]
}

allure {
    version = allureVersion
    aspectjweaver = true
    aspectjVersion = '1.8.10'
    configuration = 'compile'

    useJUnit5 {
        version = allureVersion
    }
}

task gradleUpdate(type: Wrapper) {
    gradleVersion = '5.5.1'
}